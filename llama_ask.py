import json
import sys

import requests

url = "http://localhost:11434/api/chat"

def run_llama(context, question):
    data = {
        "model": "llama3",
        "messages": [
            {"role": "user", "content": "context: {} + Question: {}".format(context, question)}
        ],
        "stream": False
    }

    response = requests.post(url, json=data)
    r = response.json()
    answer = r['message']['content']
    return answer


if __name__ == "__main__":
    context = 'The scene opens with boy_4520 wearing shirt_976d\nboy_4520 wearing short_9363\nboy_4520 has hair_691c\nboy_4520 has head_6570\nshirt_976d on boy_4520\ngirl_0576 wearing shirt_514f\nbox_ab13 on table_89f5\nAfter 1 seconds:\nAfter 2 seconds:\nshort_9363 on boy_4520\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nhead_435c of girl_0576\nAfter 3 seconds:\nchild_be22 wearing shirt_514f\nAfter 4 seconds:\nbottle_82a9 on table_89f5\nAfter 5 seconds:\ngirl_0576 wearing shirt_514f\nAfter 6 seconds:\ngirl_0576 has hair_691c\nAfter 7 seconds:\ngirl_0576 wearing shirt_514f\nAfter 8 seconds:\nbottle_82a9 on table_89f5\nAfter 9 seconds:\nhead_435c of person_397a\nchair_fb5d has leg_989e\nchair_fb5d has leg_b7f0\nbook_0417 on chair_fb5d\nAfter 10 seconds:\nchair_fb5d in room_a99e\nwindow_0985 in room_a99e\nwindow_0985 on window_0985\nAfter 11 seconds:\nchair_fb5d has leg_b7f0\nbook_0417 on table_89f5\npillow_3fab on table_89f5\npillow_3fab on chair_fb5d\npillow_ae8b on chair_fb5d\npillow_eeea on chair_fb5d\nAfter 12 seconds:\nwindow_0985 in room_a99e\nbook_4c3c on table_89f5\nbear_ad2d in chair_fb5d\nAfter 13 seconds:\nphone_09c5 on table_89f5\nAfter 14 seconds:\nhead_435c of person_397a\nchair_fb5d has leg_989e\nchair_fb5d has leg_b7f0\nchair_fb5d in room_a99e\nbook_0417 on chair_fb5d\ncurtain_6f5a on window_0985\nAfter 15 seconds:\npillow_ae8b on chair_fb5d\nAfter 16 seconds:\nbox_ab13 on table_89f5\nbook_0417 on chair_fb5d\npillow_6f72 on bed_2366\nAfter 17 seconds:\nchair_fb5d has leg_989e\nAfter 18 seconds:\nchair_fb5d has leg_b7f0\nbook_0417 on chair_fb5d\nAfter 19 seconds:\nbottle_82a9 on table_89f5\nchair_fb5d in room_a99e\nAfter 20 seconds:\nboy_4520 wearing shirt_976d\nboy_4520 wearing short_9363\nboy_4520 has hair_691c\nboy_4520 has head_435c\nshirt_976d on boy_4520\nhead_435c of boy_4520\nAfter 21 seconds:\nAfter 22 seconds:\nbottle_82a9 on table_89f5\nAfter 23 seconds:\nboy_4520 has hand_1883\nhead_6570 of boy_4520\nman_9186 wearing glass_d2d0\nman_9186 has head_435c\nhand_1883 of boy_4520\nleg_7d9d of boy_4520\nAfter 24 seconds:\nAfter 25 seconds:\nboy_4520 has head_6570\nboy_4520 has hand_1883\nhead_6570 of boy_4520\nglass_d2d0 on boy_4520\nAfter 26 seconds:\nAfter 27 seconds:\nboy_4520 wearing short_9363\nboy_4520 has leg_989e\nboy_4520 has arm_543c\nAfter 28 seconds:\nboy_4520 has hand_1883\nboy_4520 holding book_7345\nAfter 29 seconds:\nboy_4520 has leg_7d9d\nboy_4520 on chair_fb5d\nchild_be22 wearing shirt_514f\nchair_fb5d has leg_989e\nchair_fb5d has leg_b7f0\nAfter 30 seconds:\nboy_4520 has head_6570\nboy_4520 has arm_543c\nAfter 31 seconds:\nAfter 32 seconds:\nboy_4520 has arm_543c\nboy_4520 on chair_fb5d\nAfter 33 seconds:\nboy_4520 wearing short_9363\nAfter 34 seconds:\nshort_9363 on boy_4520\nhead_6570 of boy_4520\nhand_1883 of boy_4520\nAfter 35 seconds:\nboy_4520 has hand_1883\nboy_4520 has arm_543c\nboy_4520 has leg_7d9d\nleg_7d9d of boy_4520\nAfter 36 seconds:\nchild_be22 wearing shirt_976d\nchild_be22 holding book_c9c0\nchild_be22 has hair_691c\nAfter 37 seconds:\nboy_4520 wearing shirt_976d\nboy_4520 wearing short_9363\nboy_4520 has hair_691c\nchild_2ef4 wearing shirt_514f\nAfter 38 seconds:\nboy_4520 has hand_1883\nboy_4520 has leg_7d9d\nhead_6570 of boy_4520\nleg_7d9d of boy_4520\narm_543c of boy_4520\nAfter 39 seconds:\nwindow_0985 in room_a99e\nAfter 40 seconds:\nchair_fb5d has leg_989e\nchair_fb5d has leg_b7f0\nAfter 41 seconds:\nshirt_976d on boy_4520\narm_543c of boy_4520\nAfter 42 seconds:\nchild_be22 wearing shirt_976d\nAfter 43 seconds:\nboy_4520 wearing short_9363\nboy_4520 has hair_691c\nhand_1883 of boy_4520\nAfter 44 seconds:\nboy_4520 in shirt_976d\nboy_4520 has hand_1883\nbottle_82a9 on table_89f5\nAfter 45 seconds:\nboy_4520 wearing shirt_976d\nboy_4520 has head_435c\nAfter 46 seconds:\nAfter 47 seconds:\nhead_6570 of boy_4520\nhand_1883 of boy_4520\nhand_1883 of child_be22\narm_543c of boy_4520\nAfter 48 seconds:\ncup_ad1d on table_89f5\nAfter 49 seconds:\nboy_4520 in shirt_976d\nhand_3285 of boy_4520\nAfter 50 seconds:\nboy_4520 has head_435c\nboy_4520 has hand_1883\narm_543c of boy_4520\nAfter 51 seconds:\nboy_4520 using laptop_2b19\nhair_691c of boy_4520\nAfter 52 seconds:\nhand_3285 of boy_4520\nAfter 53 seconds:\nboy_4520 wearing shirt_976d\nboy_4520 at table_89f5\nbottle_82a9 on table_89f5\nAfter 54 seconds:\nboy_4520 in shirt_976d\nhead_435c of boy_4520\ncup_ad1d on table_89f5\nAfter 55 seconds:\nboy_4520 wearing shirt_976d\nbottle_82a9 on table_89f5\nAfter 56 seconds:\nboy_4520 has head_435c\nboy_4520 has hand_1883\nAfter 57 seconds:\nboy_4520 wearing pant_5160\nAfter 58 seconds:\nboy_4520 wearing short_9363\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nAfter 59 seconds:\nshirt_976d on boy_4520\nAfter 60 seconds:\nboy_4520 has short_9363\ngirl_0576 has hair_691c\nchair_fb5d near table_dd04\nnumber_c9bf on shirt_976d\nAfter 61 seconds:\nboy_4520 has hair_691c\nboy_4520 has head_435c\nAfter 62 seconds:\ngirl_0576 has head_435c\nhead_435c of girl_0576\nAfter 63 seconds:\nhand_0e19 of girl_0576\nhead_e7c5 of girl_0576\nface_3be5 of girl_0576\nAfter 64 seconds:\nchild_2ef4 has hair_691c\nglass_1bd7 on face_3be5\nAfter 65 seconds:\nchild_2ef4 wearing shirt_514f\nhand_3285 of man_9186\nhead_e7c5 of man_9186\nAfter 66 seconds:\nAfter 67 seconds:\nchild_2ef4 wearing shirt_514f\nAfter 68 seconds:\nAfter 69 seconds:\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nwoman_eb17 wearing shirt_514f\nAfter 70 seconds:\nhead_6570 of boy_5a33\nchild_2ef4 has hair_691c\nhand_3285 of boy_5a33\nboy_5a33 wearing shirt_514f\nboy_5a33 has hair_691c\nAfter 71 seconds:\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nboy_5a33 wearing short_9363\nAfter 72 seconds:\nshirt_976d on boy_5a33\nbottle_82a9 on table_89f5\nboy_5a33 wearing shirt_976d\nboy_5a33 has hand_3285\nAfter 73 seconds:\nAfter 74 seconds:\nchild_be22 wearing shirt_514f\nAfter 75 seconds:\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nwoman_eb17 wearing shirt_514f\nAfter 76 seconds:\nwoman_eb17 has hair_691c\nAfter 77 seconds:\nshirt_976d on boy_5a33\nboy_5a33 wearing pant_5160\nhand_7c86 of boy_5a33\nAfter 78 seconds:\nhead_6570 of boy_5a33\narm_543c of boy_5a33\nboy_5a33 has hair_691c\nboy_5a33 wearing short_9363\nboy_5a33 has head_6570\nAfter 79 seconds:\nshort_9363 on boy_5a33\nboy_5a33 in shirt_976d\nboy_5a33 has hand_1883\nAfter 80 seconds:\nhand_1883 of boy_5a33\nboy_5a33 wearing shirt_976d\nAfter 81 seconds:\ncup_ad1d on table_89f5\nAfter 82 seconds:\nshirt_976d on boy_5a33\nbottle_82a9 on table_89f5\nAfter 83 seconds:\nshort_9363 on boy_5a33\nleg_b7f0 of boy_5a33\nAfter 84 seconds:\nshirt_976d on woman_eb17\nshort_9363 on woman_eb17\nleg_b7f0 of woman_eb17\nwoman_eb17 wearing short_9363\nwoman_eb17 wearing shirt_976d\nwoman_eb17 has leg_b7f0\nwoman_eb17 wearing shoe_f7a4\nAfter 85 seconds:\nwoman_eb17 has hand_7c86\nwoman_eb17 on bed_2366\nhand_7c86 of woman_eb17\nAfter 86 seconds:\nchair_fb5d has leg_989e\nAfter 87 seconds:\nchild_be22 has arm_543c\nchild_be22 has hand_7c86\nchair_fb5d on chair_fb5d\nleg_7d9d of woman_eb17\nwoman_eb17 has hair_691c\nhead_bee2 of woman_eb17\nAfter 88 seconds:\nchild_be22 wearing shirt_976d\nchild_be22 has hair_691c\nchild_be22 wearing short_9363\nchild_be22 has hand_1883\nchild_be22 holding book_7fb4\nchair_fb5d has leg_7d9d\npillow_ae8b on chair_fb5d\nAfter 89 seconds:\nchild_be22 has hand_3285\nchild_be22 on chair_fb5d\nchair_fb5d near woman_eb17\narm_543c of woman_eb17\nhand_3285 of woman_eb17\nwoman_eb17 wearing short_9363\nwoman_eb17 wearing shirt_976d\nAfter 90 seconds:\nshort_9363 on woman_eb17\nchair_fb5d has leg_989e\nleg_7d9d of woman_eb17\nwoman_eb17 has hair_691c\nwoman_eb17 has arm_543c\nwoman_eb17 has hand_3285\nAfter 91 seconds:\nwoman_eb17 in shirt_976d\nAfter 92 seconds:\nhair_691c on woman_eb17\nwoman_eb17 wearing shirt_976d\nwoman_eb17 has hand_1883\nwoman_eb17 has head_bee2\nAfter 93 seconds:\nwoman_eb17 has shirt_976d\nwoman_eb17 has nose_fe8f\narm_3762 of woman_eb17\nAfter 94 seconds:\nhair_691c of child_1a3a\nhand_3285 on boy_5a33\nwoman_eb17 wearing shirt_976d\nwoman_eb17 in chair_fb5d\nwoman_eb17 has ear_f6ca\nboy_5a33 has hand_3285\near_f6ca of child_1a3a\nleg_530f of chair_2f58\nnose_180c of child_1a3a\nAfter 95 seconds:\nAfter 96 seconds:\nboy_5a33 wearing shirt_514f\nboy_5a33 has hair_691c\nlogo_2d48 on shirt_976d\nAfter 97 seconds:\nshirt_514f on boy_5a33\nboy_5a33 has hand_3285\nboy_5a33 holding food_3845\nboy_5a33 has arm_543c\nboy_2b30 wearing shirt_976d\nAfter 98 seconds:\nchild_2ef4 has hair_691c\nchild_2ef4 wearing shirt_976d\nhand_3285 of boy_5a33\nAfter 99 seconds:\nshirt_514f on boy_5a33\nboy_5a33 wearing shirt_514f\nboy_5a33 wearing short_9363\nAfter 100 seconds:\nboy_5a33 has hand_3285\nboy_5a33 wearing pant_5160\nboy_5a33 has glass_1bd7\nboy_5a33 wearing hat_e216\nboy_2b30 wearing shirt_514f\nboy_2b30 has hair_691c\nAfter 101 seconds:\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nshirt_514f on girl_0576\nhead_bee2 of boy_2b30\nAfter 102 seconds:\nAfter 103 seconds:\nhair_691c on girl_0576\ngirl_0576 wearing shirt_976d\nshirt_514f on girl_0576\nAfter 104 seconds:\nboy_5a33 wearing shirt_514f\nhead_bee2 of boy_2b30\nboy_2b30 wearing shirt_976d\nAfter 105 seconds:\nboy_5a33 has hair_691c\nboy_5a33 sitting on chair_2f58\nAfter 106 seconds:\nAfter 107 seconds:\nhair_691c on boy_5a33\nshirt_514f on boy_5a33\nboy_5a33 has hair_691c\nAfter 108 seconds:\ngirl_0576 wearing glass_1bd7\nshirt_514f on girl_0576\nchild_2ef4 wearing shirt_514f\nboy_5a33 wearing glass_1bd7\nhead_bee2 of boy_2b30\nAfter 109 seconds:\nAfter 110 seconds:\nAfter 111 seconds:\nhand_0e19 of girl_0576\nboy_5a33 wearing shirt_514f\nAfter 112 seconds:\nshirt_514f on boy_5a33\nchild_2ef4 wearing shirt_514f\nboy_5a33 has hair_691c\nAfter 113 seconds:\nman_9186 wearing glass_1bd7\nman_9186 has hair_691c\nboy_2b30 holding bottle_3a4c\nAfter 114 seconds:\nshirt_514f on boy_5a33\nboy_5a33 wearing short_9363\nAfter 115 seconds:\nAfter 116 seconds:\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nshirt_514f on boy_5a33\nboy_5a33 wearing glass_1bd7\nAfter 117 seconds:\nAfter 118 seconds:\nAfter 119 seconds:\nhair_691c on girl_0576\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nshirt_514f on girl_0576\nhead_bee2 on girl_0576\nAfter 120 seconds:\nboy_2b30 has hair_691c\nAfter 121 seconds:\nboy_5a33 wearing shirt_514f\nboy_5a33 has hair_691c\nAfter 122 seconds:\ngirl_0576 has head_bee2\nboy_2b30 has hair_691c\nAfter 123 seconds:\ngirl_0576 wearing shirt_514f\ngirl_0576 has hair_691c\nboy_2b30 has head_bee2\nAfter 124 seconds:\nshirt_514f on girl_0576\nhand_0e19 of girl_0576\nhead_bee2 on girl_0576\nAfter 125 seconds:\ngirl_0576 has head_bee2\ngirl_0576 wearing short_9363\nboy_2b30 has hair_691c\nhat_008f on head_bee2\n'
    question = 'How many kids are in this room? Guess the most likely answer among these options: 0: 2, 1: 4 , 2: 3, 3: 1 Respond only with a single number between 0 and 3. Do not produce any other output. If enough information is not given, still make a guess to result in one out of the given options.'

    print("\nResponse: {}".format(run_llama(context, question)))
